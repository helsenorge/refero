{
  "title": "Test fjeren uttrykk ved datatreciever",
  "resourceType": "Questionnaire",
  "language": "nb-NO",
  "name": "NHN_Test_MattematiskUttrykk",
  "status": "draft",
  "publisher": "NHN",
  "meta": {
    "profile": ["http://ehelse.no/fhir/StructureDefinition/sdf-Questionnaire"],
    "tag": [{ "system": "urn:ietf:bcp:47", "code": "nb-NO", "display": "Bokm√•l" }],
    "security": [{ "code": "3", "display": "Helsehjelp (Full)", "system": "urn:oid:2.16.578.1.12.4.1.1.7618" }]
  },
  "contact": [{ "name": "http://www.nhn.no" }],
  "subjectType": ["Patient"],
  "extension": [
    {
      "url": "http://helsenorge.no/fhir/StructureDefinition/sdf-sidebar",
      "valueCoding": { "system": "http://helsenorge.no/fhir/ValueSet/sdf-sidebar", "code": "1" }
    },
    {
      "url": "http://helsenorge.no/fhir/StructureDefinition/sdf-information-message",
      "valueCoding": { "system": "http://helsenorge.no/fhir/ValueSet/sdf-information-message", "code": "1" }
    },
    {
      "url": "http://helsenorge.no/fhir/StructureDefintion/sdf-itemControl-visibility",
      "valueCodeableConcept": {
        "coding": [
          { "system": "http://helsenorge.no/fhir/CodeSystem/AttachmentRenderOptions", "code": "hide-help", "display": "Hide help texts" },
          {
            "system": "http://helsenorge.no/fhir/CodeSystem/AttachmentRenderOptions",
            "code": "hide-sublabel",
            "display": "Hide sublabel texts"
          }
        ]
      }
    }
  ],
  "id": "c48cbb8a-e576-444f-bd79-540107aa9e29",
  "item": [
    {
      "linkId": "1d5e969b-c20c-49d6-bab0-e1b2322d02a4",
      "type": "group",
      "text": "Input",
      "item": [
        { "linkId": "Value1", "type": "integer", "text": "Input 1", "required": false },
        { "linkId": "Value2", "type": "integer", "text": "Input 2", "required": false },
        {
          "linkId": "Sum",
          "type": "integer",
          "text": "Sum",
          "required": false,
          "extension": [
            {
              "url": "http://ehelse.no/fhir/StructureDefinition/sdf-calculatedExpression",
              "valueString": "QuestionnaireResponse.descendants().where(linkId='Value1').answer.value + QuestionnaireResponse.descendants().where(linkId='Value2').answer.value"
            }
          ],
          "readOnly": true
        }
      ],
      "required": false
    },
    {
      "linkId": "5fea9b0e-671d-4118-9026-f9c2dbc1e52e",
      "type": "group",
      "text": "Oppsummering",
      "item": [
        {
          "linkId": "7b18d471-31e6-476f-8515-3e3a3056d83e",
          "type": "integer",
          "text": "Sum",
          "required": false,
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [{ "system": "http://hl7.org/fhir/ValueSet/questionnaire-item-control", "code": "data-receiver" }]
              }
            },
            {
              "url": "http://hl7.org/fhir/StructureDefinition/cqf-expression",
              "valueString": "QuestionnaireResponse.descendants().where(linkId='Sum').answer.value"
            },
            {
              "url": "http://ehelse.no/fhir/StructureDefinition/sdf-calculatedExpression",
              "valueString": "QuestionnaireResponse.descendants().where(linkId='Value1').answer.value + QuestionnaireResponse.descendants().where(linkId='Value2').answer.value"
            }
          ],
          "readOnly": true,
          "enableWhen": [{ "answerBoolean": true, "question": "Sum", "operator": "exists" }]
        }
      ],
      "required": false
    }
  ]
}
